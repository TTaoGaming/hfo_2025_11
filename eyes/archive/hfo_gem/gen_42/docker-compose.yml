version: '3.9'
services:
# 1. THE NERVOUS SYSTEM (Stigmergy)
# Technology: NATS JetStream (Proven)
# Function: Decoupled communication. Agents post to topics, not ports.
nats:
image: nats:latest
command: "-js"
ports: ["4222:4222", "8222:8222"]
volumes:
- hfo_nats_data:/data

2. THE MUSCLE (Orchestration)
Technology: Temporal.io (Proven)
Function: Durable Execution. "If it crashes, it resumes."

temporal:
image: temporalio/auto-setup:latest
environment:
- DB=postgresql
- DB_PORT=5432
- POSTGRES_USER=postgres
- POSTGRES_PWD=obsidian
- POSTGRES_DB=temporal
depends_on:
- postgres
ports: ["7233:7233", "8233:8233"]

3. THE MEMORY (Karma)
Technology: PostgreSQL + pgvector (Proven)
Function: Long-term memory and embedding storage.

postgres:
image: pgvector/pgvector:pg16
environment:
- POSTGRES_DB=hfo_memory
- POSTGRES_USER=postgres
- POSTGRES_PASSWORD=obsidian
ports: ["5432:5432"]
volumes:
- hfo_pg_data:/var/lib/postgresql/data

4. THE EYES (Observability)
Technology: Jaeger (Proven)
Function: Visualizing the Stigmergy flows.

jaeger:
image: jaegertracing/all-in-one:latest
ports: ["16686:16686"]

volumes:
hfo_nats_data:
hfo_pg_data:
